

//**********************************************************************************************************
//????????????3???????????? "-"?"."?"/"????????????????
// ?????????2001-2-13 2001 2001-2 2001.2.13 2001.2 2001/2/3?????? 1-1-1 ? 9999-12-31 
// ?????????????????????2001-2-29 2001-4-31 ???????
//???strDate ---- ??????????
// intFlag: 1 ---- ????? 2 ---- ??????? 0 ---- ???????
//????true ---- ???? false ---- ?????
function fnCheckDate(strDate,intFlag)
{
var strCheckDate = strDate + ""; //??????????????????

if(strCheckDate == "") //????,?????????????false
{
return false;
} 

//?????????????????
var intIndex = -1; //???????????????????????????-1,??? ?0 - String.length - 1?
var arrDate; //???????
var regExpInfo = /\./; //????????????? "."???

//???????????replace??????"."?"/"??"-",???????????????????? 2001/3-2,?????????????
intIndex = strCheckDate.search(regExpInfo); //?????? "."
if(intIndex == - 1) //??? 
{
	regExpInfo = /-/;
	intIndex = strCheckDate.search(regExpInfo);
	
	if(intIndex == -1)
	{
		regExpInfo = /\//; //?????? "/"
		intIndex = strCheckDate.search(regExpInfo); 
		
		if(intIndex == -1)
		{	
			if(strCheckDate.length==4){
				arrDate = new Array(strCheckDate);
			}else{
				//??????
				if(strCheckDate.length==8){
					var yearStr = strCheckDate.substring(0,4);
					var monthStr = strCheckDate.substring(4,6);
					var dayStr = strCheckDate.substring(6,8);
					
					arrDate = new Array(yearStr,monthStr,dayStr);
				}else{
					return false;
				}
			}
			
		}
		else
		{
			arrDate = strCheckDate.split("/"); //2001/3/7 ?
		}
	}
	else
	{
		arrDate = strCheckDate.split("-"); //2001-3-7 ?
	}
}
else
{
	arrDate = strCheckDate.split("."); //2001.3.7 ?
}



if(arrDate.length > 3) //??????????3????????????????????false
{
	return false;
}
else if(arrDate.length > 0) 
{
//???????
if(fnIsIntNum(arrDate[0])) //????
{
	
if(parseInt(arrDate[0],10) < 1 || parseInt(arrDate[0],10) > 9999) //????1 - 9999
{
return false;
} 
}
else
{
return false; //?????????
}

//???????
if(arrDate.length > 1)
{

if(fnIsIntNum(arrDate[1])) //????
{
if(parseInt(arrDate[1],10) < 1 || parseInt(arrDate[1],10) > 12)
{
return false;
} 
}
else
{
 
return false;
}




}
else //???
{
if(intFlag != 2) //?????
{
return false;
}
}

//???????
if(arrDate.length > 2)
{
if(fnIsIntNum(arrDate[2])) //????
{
var intDayCount = fnComputerDay(parseInt(arrDate[0],10),parseInt(arrDate[1],10));

if(intDayCount < parseInt(arrDate[2],10))
{
return false;
} 
}
else
{
return false;
}
}
else
{
if(intFlag == 0) //?????
{
return false;
}
}
}
return true;
}

//**********************************************************************************************************
//???????????
//???strNum ---- ????????
//????true ---- ?? false ---- ???
function fnIsIntNum(strNum)
{
var strCheckNum = strNum + "";
if(strCheckNum.length < 1) //????
return false;
else if(strCheckNum.charAt(0)=='0')
strCheckNum = strCheckNum.substring(1);
else if(isNaN(strCheckNum)) //????
return false;
else if(parseInt(strCheckNum,10) < 1) //????
return false; 
else if(parseFloat(strCheckNum) > parseInt(strCheckNum,10)) //???? 
return false;

return true;
}

//**********************************************************************************************************
//?????intYear?intMonth????
//????intYear?intMonth????
function fnComputerDay(intYear,intMonth)
{
var dtmDate = new Date(intYear,intMonth,-1);
var intDay = dtmDate.getDate() + 1;

return intDay; 
}

//********************************************************************************************************** //????????????
//?????????????
function fnRemoveBrank(strSource)
{
return strSource.replace(/^\s*/,'').replace(/\s*$/,'');
}


//check date
function checkDate(element){
	var intCheckRadio=0;
	var dateStr = element.value+"";
	if(dateStr!=""){
		if(!fnCheckDate(dateStr,intCheckRadio))
		{
			alert("日期不合法");
			element.focus();
		}
	}
}
